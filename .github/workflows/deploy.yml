name: Deploy to Vercel

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # üß© 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      - uses: actions/checkout@v3

      # üü£ 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º pnpm (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–µ—Ä—Å–∏–∏)
      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8.9.0   # ‚úÖ <-- –í–û–¢ –≠–¢–û –ì–õ–ê–í–ù–û–ï

      # ‚öôÔ∏è 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js —Å –∫—ç—à–µ–º
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'

      # üì¶ 4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
      - name: Install dependencies
        run: pnpm install

      # üèóÔ∏è 5. –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç
      - name: Build project
        run: pnpm build

      # üöÄ 6. –î–µ–ø–ª–æ–π –Ω–∞ Vercel
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
